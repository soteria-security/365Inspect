{
	"FindingName": "[VULNERABLE] - CIS 2.6 + 2.7: Correct Role Permissions are not set conform CIS Standards. One of the values returned True, instead of False.",
	"Description": "All property values should be False instead of True: AllowedToCreateApps,AllowedToCreateSecurityGroups,AllowedToReadOtherUsers,AllowedToSignUpEmailBasedSubscriptions,AllowEmailVerifiedUsersToJoinOrganization. If one of the values is True this could lead to: 1. A standard user gaining sensitive information about other users 2. Users creating groups with possible elevated privileges, 3. Creating possible Malicious apps without restrictions.",
	"Remediation": "Based on the values of Affected Objects this are possible mitigations for all property values to set them to false: 1. Connect-MsolService > 2. Set-MsolCompanySettings -UsersPermissionToReadOtherUsersEnabled $false and Set-MsolCompanySettings -UsersPermissionToCreateGroupsEnabled $false and Set-MsolCompanySettings -UsersPermissionToUserConsentToAppEnabled $false > 3. Set-AzureADMSAuthorizationPolicy -DefaultUserRolePermissions @{'PermissionGrantPoliciesAssigned' = @(); 'AllowedToCreateApps' = $false; 'AllowedToCreateSecurityGroups' = $false; 'AllowedToReadOtherUsers' = $false } > 4. For More recommendations please refer to the references stated below.",
	"DefaultValue": "AllowedToCreateApps: True <br/> AllowedToCreateSecurityGroups: True <br/> AllowedToReadOtherUsers: True <br/> AllowedToSignUpEmailBasedSubscriptions True <br/> AllowEmailVerifiedUsersToJoinOrganization True",
	"ExpectedValue": "All False",
	"ReturnedValue" : "",
	"Impact": "Critical",
	"RiskRating": "Critical",
	"AffectedObjects": "",
	"References": [
		{
			"Url": "https://soteria.io/azure-ad-default-configuration-blunders/",
			"Text": "Azure AD Default Configuration Blunders"
		},
		{
			"Url": "https://www.pentestpartners.com/security-blog/azure-ad-attack-of-the-default-config/",
			"Text": "Azure AD. Attack of the Default Config"
		},
		{
			"Url":"https://m365security.net/2021/04/05/detect-when-compromised-end-user-connects-to-azure-ad-for-reconnaissance/",
			"Text":"Detect when compromised end-user connects to Azure-AD for reconnaissance"
		}
	]
}