{
	"FindingName": "External Forwarding and AutoForwarding is not correctly Configured",
	"ProductFamily": "Microsoft Exchange",
	"CVS": "9.1",
	"Description": "AllowedOOFType should not match 'External' and AutoForwardEnabled should not match 'True'. External Forwarding should be disabled to avoid information leaks and disclosure. Attackers often create these rules to exfiltrate data from your tenancy, this could be accomplished via access to an end-user account or otherwise.",
	"Remediation": "1. Connect to Exchange Online using Connect-ExchangeOnline. > 2. RUN: Remove-TransportRule {RuleName} > 3. Set-RemoteDomain Default -AutoForwardEnabled $false > 4. Verify if the setting is enabled > 5. RUN: $rejectMessageText = 'To improve security, auto-forwarding rules to external addresses have been disabled. Please contact your Microsoft Partner if you'd like to set up an exception.' > 5. New-TransportRule -name 'Client Rules To External Block' -Priority 0 -SentToScope NotInOrganization -FromScope InOrganization -MessageTypeMatches AutoForward -RejectMessageEnhancedStatusCode 5.7.1 -RejectMessageReasonText $rejectMessageText ",
	"DefaultValue": "AllowedOOFType: External <br /> AutoForwardEnabled: True,",
	"ExpectedValue": "AllowedOOFType: Not External <br /> AutoForwardEnabled: False",
    "ReturnedValue" : "",	
	"Impact": "Critical",
	"RiskRating": "Critical",
	"AffectedObjects": "",
	"References": [
		{
			"Url": "https://docs.microsoft.com/en-us/exchange/policy-and-compliance/mail-flow-rules/mail-flow-rule-procedures?view=exchserver-2019",
			"Text": "Procedures for mail flow rules in Exchange Server"
		},
		{
			"Url": "https://docs.microsoft.com/en-us/archive/blogs/exovoice/disable-automatic-forwarding-in-office-365-and-exchange-server-to-prevent-information-leakage",
			"Text": "Disable automatic forwarding in Office 365 and Exchange Server to prevent information leakage"
		},
		{
			"Url": "https://docs.microsoft.com/en-us/powershell/module/exchange/set-remotedomain?view=exchange-ps",
			"Text": "Set-RemoteDomain"
		},
		{
			"Url": "https://techcommunity.microsoft.com/t5/exchange-team-blog/all-you-need-to-know-about-automatic-email-forwarding-in/ba-p/2074888#:~:text=%20%20%20Automatic%20forwarding%20option%20%20,%",
			"Text": "All you need to know about automatic email forwarding in Exchange Online"
		}
	]
}